<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>QBluetooth: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li class="current"><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>QBluetooth Documentation</h1>  </div>
</div>
<div class="contents">

QBluetooth is a <strong>3rd party</strong> bluetooth library written on Qt supported on Symbian and Windows. Its architecture is based on <a class="ext-link" href="http://www.forum.nokia.com/info/sw.nokia.com/id/89261a1d-ed6d-4cc5-8855-8250a33de328/S60_Platform_Bluetooth_API_Developers_Guide.html"><span class="icon"> </span>S60 Platform: Bluetooth API Developer's Guide</a>.
</p>
<p>

The idea is to create a library implementation using Qt (a DLL) of the S60 bluetooth API easy to use by anyone with basic knowledge of Qt. 
</p>
<p>
So the architecture was extracted from S60 bluetooth API, and also source code was used from the following examples: 
</p>
<ul><li><a class="ext-link" href="http://www.forum.nokia.com/info/sw.nokia.com/id/385f811a-2940-444f-b906-e5d3444e121c/S60_Platform_Bluetooth_OBEX_Example_v1_0_en.zip.html"><span class="icon"> </span>S60 Platform Bluetooth OBEX Example</a> 
</li><li><a class="ext-link" href="http://www.forum.nokia.com/info/sw.nokia.com/id/e56fccb6-2d70-4a02-9008-7b3e97927057/S60_Platform_Bluetooth_Point_to_Multipoint_Example.html"><span class="icon"> </span>S60 Platform Bluetooth Point to Multipoint Example</a> 
</li><li><a class="ext-link" href="http://library.forum.nokia.com/index.jsp?topic=/S60_5th_Edition_Cpp_Developers_Library/GUID-441D327D-D737-42A2-BCEA-FE89FBCA2F35/Chat/doc/index.html"><span class="icon"> </span>S60 blueooth Serial Port Chat</a> 
</li></ul><p>
and the basic guide for combining all these was <a class="ext-link" href="http://wiki.forum.nokia.com/index.php/How_to_use_Symbian_C%2B%2B_and_Qt_for_Symbian_Code_together"><span class="icon"> </span>Using Qt and Symbian C together</a>

</p>
<p>
NOTE: for more detailed description of the the library's components please advise the documentation. Documentation can be found in this site <a class="ext-link" href="./index.html"><span class="icon"> </span>QBluetooth Documentation</a>.
</p>
<p>
An application using QBluetooth can be found here <a class="ext-link" href="http://wiki.forum.nokia.com/index.php/QuteMessenger_-_Bluetooth_Chat"><span class="icon"> </span>QuteMessenger - A Qt application using QBluetooth</a>
</p>
<h1 id="BasicInformationContainerClasses">Basic Information Container Classes</h1>
<ul><li><i><a class="ext-link" href="./class_q_bt_address.html"><span class="icon"> </span>QBtAddress</a></i> : that represents the device's bluetooth address 

</li><li><i><a class="ext-link" href="./class_q_bt_service.html"><span class="icon"> </span>QBtService</a></i> : all the necessary information about a bluetooth service 
</li><li><i><a class="ext-link" href="./class_q_bt_device.html"><span class="icon"> </span>QBtDevice</a></i> : all the information needed about any remote bluetooth device 
</li><li><i><a class="ext-link" href="./class_q_bt_local_device.html"><span class="icon"> </span>QBtLocalDevice</a></i> : implemented only with static functions through which user can access information of the local device
</li></ul><h1 id="OperationalClasses">Operational Classes</h1>
<ul><li><i><a class="ext-link" href="./class_q_bt_device_discoverer.html"><span class="icon"> </span>QBtDeviceDiscoverer</a></i>: the mechanism of the device discovery

</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_single_device_selector_u_i.html"><span class="icon"> </span>QBtSingleDeviceSelectorUI</a></i>: a simple widget to select a bluetooth device. Device discovery is initiated when widget is shown. Created for convenience if a user simply wants to select a discovered device to proceed to other operations
</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_service_discoverer.html"><span class="icon"> </span>QBtServiceDiscoverer</a></i>: provides the mechanism to inquire a given device for the bluetooth services it supports
</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_service_advertiser.html"><span class="icon"> </span>QBtServiceAdvertiser</a></i>: class responsible to advertise a given bluetooth service
</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_object_exchange_client.html"><span class="icon"> </span>QBtObjectExchangeClient</a></i> : OBEX client, connects to a remote OBEX server to send/retrieve data and files
</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_object_exchange_server.html"><span class="icon"> </span>QBtObjectExchangeServer</a></i> : OBEX server, waits for clients to connect and ready to serve any OBEX request

</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_serial_port_client.html"><span class="icon"> </span>QBtSerialPortClient</a></i> : Serial Port (SP) client, connect to SP server to send/receive raw data through serial port
</li></ul><ul><li><i><a class="ext-link" href="./class_q_bt_serial_port_server.html"><span class="icon"> </span>QBtSerialPortServer</a></i> : Serial Port server, ready to accept client connections to also send/receive raw data
</li></ul><h1 id="Buildingthelibrary">Building the library</h1>
<p>
Use QBluetooth.pro file to open the project. Next step is create the DLL. 
</p>
<p>
If compiled for Symbian and Carbide is used as IDE then we Freeze Exports (Project-&gt;Freeze Exports) and it is ready.
If compiled for Windows (in my case i used Visual Studio 2008 as IDE) just compile and the .dll and .lib files will be generated.
</p>

<h1 id="Includingthelibrary">Including the library</h1>
<p>
The following lines must be inserted in the .pro file of the project that is going to use the QBluetooth library.
</p>
<p>
If compiling for Symbian, add in <i>symbian</i> scope:
</p>
<pre class="wiki">    INCLUDEPATH += /epoc32/include/QBlueTooth
    LIBS += -lQBluetooth \
    TARGET.CAPABILITY = LocalServices \
        NetworkServices \
        ReadUserData \
        UserEnvironment \
        WriteUserData
    addFiles.sources = $(EPOCROOT)Epoc32\release\$(PLATFORM)\$(CFG)\QBluetooth.dll
    addFiles.path = \sys\bin
    DEPLOYMENT += addFiles
</pre><p>
If compiling for Windows, add in <i>win32</i> scope:

</p>
<pre class="wiki">    LIBS += -l$$(QTDIR)\Nokia_Contest_Bluetooth\QBluetooth\bin\QBluetooth \
        -L$$(QTDIR)\Nokia_Contest_Bluetooth\QBluetooth\bin
    INCLUDEPATH = ..\QBluetooth
    HEADERS += ..\QBluetooth\QBluetooth.h
</pre><p>
The LIBS label sets the location of the file containing the .lib file, the INCLUDEPATH sets the location of the header file and HEADERS is used to specify the exact header to be included.
</p>
<p>
At any case, whenever one of the library classes is to be used, the developer must include &lt;QBluetooth&gt;.
</p>
<h1 id="Codeexamples">Code examples</h1>
<h2 id="Discoveringdevicesinrange">Discovering devices in range</h2>
<p>
<a class="ext-link" href="./class_q_bt_device_discoverer.html"><span class="icon"> </span>QBtDeviceDiscoverer</a> is used to inquire for bluetooth devices in range.

</p>
<ul><li>create new instance
</li><li>call <a class="ext-link" href="./class_q_bt_device_discoverer.html#a76e9223d3b2330c1c26c94bee5a1ae5f"><span class="icon"> </span>startDiscovery()</a> to initiate inquiry
</li><li>call <a class="ext-link" href="./class_q_bt_device_discoverer.html#a74851bd623fc4d333791d6a295c10478"><span class="icon"> </span>getInquiredDevices()</a> to retrieve the devices found so far or connect to  SIGNAL <strong><a class="ext-link" href="./class_q_bt_device_discoverer.html#aa88fadfe4eabe2b5ad1d7b0eb92653d3"><span class="icon"> </span>newDeviceFound (QBtDevice)</a></strong> to be reported each time a device is found
</li></ul><pre class="wiki">QBtDeviceDiscoverer* deviceDiscoverer = new QBtDeviceDiscoverer(this);
connect(deviceDiscoverer , SIGNAL(newDeviceFound (QBtDevice)), 
        this, SLOT(handlerFunction(QBtDevice)));
deviceDiscoverer -&gt;startDiscovery();

</pre><h2 id="Discoveringservicesonadevice">Discovering services on a device</h2>
<p>
<a class="ext-link" href="./class_q_bt_service_discoverer.html"><span class="icon"> </span>QBtServiceDiscoverer</a> is used to inquire a remote device for the services it supports. 
After instantiation, user can call one of the 3 overloads of startDiscovery()
</p>
<ul><li><a class="ext-link" href="./class_q_bt_service_discoverer.html#a3477976884356670db43a5ab337976f7"><span class="icon"> </span>startDiscovery(QBtDevice*)</a> : get all the device's supported services
</li><li><a class="ext-link" href="./class_q_bt_service_discoverer.html#a50a50d9dcd06d0aa19077f0f07646149"><span class="icon"> </span>startDiscovery(QBtDevice*,QBtConstants::!ServiceClass)</a> : get all the device's supported services whose UUID equals to the given
</li><li><a class="ext-link" href="./class_q_bt_service_discoverer.html#a1471b3ffba854e197e4c105fdc884c89"><span class="icon"> </span>startDiscovery(QBtDevice*,QBtConstants::!ServiceProtocol)</a> : get all the device's supported services whose mechanism contains the service protocol given as argument

</li></ul><p>
Use <a class="ext-link" href="./class_q_bt_service_discoverer.html#af9d1e5edcf33c98916c0e0f19f6f860a"><span class="icon"> </span>getInquiredServices()</a> to get the services found so far or connect to the SIGNAL <a class="ext-link" href="./class_q_bt_service_discoverer.html#a2ef2eb229485582e224d91aec67d7773"><span class="icon"> </span>newServiceFound(const QBtDevice&amp;, QBtService)</a> to be reported each time a service is found.
</p>
<p>
Example: inquire a device (variable name <i>remoteDevice</i>) for all the Serial Port Protocols (SPP) it supports.
</p>

<pre class="wiki">	QBtServiceDiscoverer* serviceDiscoverer = new QBtServiceDiscoverer(this);
	connect(serviceDiscoverer, SIGNAL(newServiceFound(const QBtDevice&amp;, QBtService)), 
	        this, SLOT(handlerFunction(const QBtDevice&amp;, QBtService)));
	serviceDiscoverer-&gt;startDiscovery(remoteDevice, QBtConstants::SerialPort);
</pre><h2 id="Publishaservice">Publish a service</h2>
<p>
<a class="ext-link" href="./class_q_bt_service_advertiser.html"><span class="icon"> </span>QBtServiceAdvertiser</a> is responsible to advertise a given bluetooth service.
</p>
<p>
After the instantiation of the class, <a class="ext-link" href="./class_q_bt_service_advertiser.html#a52bc79594aefff3eb687688b4fdb4fad"><span class="icon"> </span>startAdvertising(const QBtService&amp;)</a> can be called to start advertising the given bluetooth service. If successful then <a class="ext-link" href="./class_q_bt_service_advertiser.html#ad3b82bfa197b6ee4454082b4ebe7de6b"><span class="icon"> </span>advertisingStarted(const QBtService&amp;)</a> signal is emitted.

</p>
<p>
NOTE: Currently there is no implementation on the Windows platform so after the instantiation of this object, any call to any function will emit an <a class="ext-link" href="./class_q_bt_service_advertiser.html#a11393d220f3013ab21b310253330d892"><span class="icon"> </span>error(QBtServiceAdvertiser::FeatureNotSupported)</a> signal.
</p>
<pre class="wiki">	QBtService newService;
	newService.SetName(p_ptr-&gt;trService-&gt;GetName());
	newService.SetClass(QBtConstants::SerialPort);
	newService.SetCommPort(aChannel);
	newService.AddProtocol(QBtConstants::L2CAP);
	newService.AddProtocol(QBtConstants::RFCOMM);
	
	QBtServiceAdvertiser* advertiser = new QBtServiceAdvertiser(this);
	advertiser-&gt;StartAdvertising(service);	
</pre><h2 id="Sendreceiveafile">Send/receive a file</h2>
<p>
<a class="ext-link" href="./class_q_bt_object_exchange_client.html"><span class="icon"> </span>QBtObjectExchangeClient</a> is used to connect to a remote OBEX server and send or recieve files or raw data.

</p>
<p>
Example connecting to a remote OBEX server. At successful connection user send a file to the server.
</p>
<p>
Header
</p>
<pre class="wiki">#include &lt;QBluetooth&gt;

class FileSender
{
Q_OBJECT

public:
    FileSender();

protected:
    void Setup();

private slots:
    void SendFile();

private:
    QBtObjectExchangeClient* client;
}
</pre><p>
Source
</p>
<pre class="wiki">FileSender::FileSender()
{
    Setup();
}

void FileSender::Setup()
{
    client = new QBtObjectExchangeClient(this);
    connect(client, SIGNAL(connectedToServer()), this,SLOT(SendFile()));
    client-&gt;ConnectToServer(remoteDevice, remoteService); // remoteDevice &amp; remoteService are acquired from the previous examples
}

void FileSender::SendFile()
{
    client-&gt;PutFile("C:\\picture.jpg");
}

</pre><h2 id="OBEXserver">OBEX server</h2>
<p>
<a class="ext-link" href="./class_q_bt_object_exchange_server.html"><span class="icon"> </span>QBtObjectExchangeServer</a> is used to create an OBEX server. After instantiation user can call <a class="ext-link" href="./class_q_bt_object_exchange_server.html#a0eb4d3b5d82b34d109cc7433b34d48c8"><span class="icon"> </span>startServer(const QString&amp;)</a> to start the server. The feedback from the server's operations is given through SIGNALS.
</p>
<pre class="wiki">    QBtObjectExchangeServer* server = new QBtObjectExchangeServer(this);
    server-&gt;startServer("MyObexServer");
</pre><p>

&lt;u&gt;NOTE: not implemented for Windows.&lt;/u&gt;
</p>
<h2 id="ConnectingtoaSerialPortServer">Connecting to a Serial Port Server</h2>
<p>
In this case we use <a class="ext-link" href="./class_q_bt_serial_port_client.html"><span class="icon"> </span>QBtSerialPortClient</a>. Call <a class="ext-link" href="./class_q_bt_serial_port_client.html#ad15d5078a06b111ba81452f0a4edf1ad"><span class="icon"> </span>connect(const QBtDevice&amp;, const QBtService&amp;)</a> to connect to a remote Serial Port (SPP) Server. If successfull client can send data using <a class="ext-link" href="./class_q_bt_serial_port_client.html#afd7f72738c717e1eb0a42b5f64a5d69c"><span class="icon"> </span>sendData(const QString &amp;)</a> function and reports received data through SIGNAL <a class="ext-link" href="./class_q_bt_serial_port_client.html#aa5d793a84a4dde54de51a29b83dac546"><span class="icon"> </span>dataReceived(const QString)</a>.

</p>
<h2 id="CreatingaSerialPortServer">Creating a Serial Port Server</h2>
<p>
<a class="ext-link" href="./class_q_bt_serial_port_server.html"><span class="icon"> </span>QBtSerialPortServer</a> is used. Call <a class="ext-link" href="./class_q_bt_serial_port_server.html#a01abd43a827da150d87911c3dfa81763"><span class="icon"> </span>startServer(const QString&amp;)</a> to start server and set the name of the publishing service and then wait for a client to connect. When a client is connected, it is reported through <a class="ext-link" href="./class_q_bt_serial_port_server.html#a86c9f24f68a8fbd18f1653a598fc207d"><span class="icon"> </span>clientConnected(QBtAddress)</a> SIGNAL. At this point server is able to send data through sendData(const QString) and the data received are reported through <a class="ext-link" href="./class_q_bt_serial_port_server.html#abee23ef5ea738a22652f8c9b2ba14fc9"><span class="icon"> </span>dataReceived(QString)</a>.

</p>
<p>
NOTE: not implemented for Windows.
</p>
<h1 id="Otherusefulinformation">Other useful information</h1>
<p>
On the Windows implementation side, the bluetooth functions are provided by the Bluesoleil SDK. So in order to use the Windows implementation user must download the Bluesoleil SDK and Bluesoleil Drivers 6.4 and above. I know that this restriction is a drawback but I had a couple of months of experience on that SDK so it was the only chance for me to make a Windows implementation at this moment...but it works. 
</p>
<p>
NOTE: if someone wants to use this implementation, consider to update the path of the folder containing the SDK in the QBluetooth.pro in the <i>win32</i> scope.
</p>
<p>
The Win Serial port functions are provided by Thierry Schneider through Tserial_event: 

</p>
<blockquote>
<p>
Copyright @ 2001-2002     Thierry Schneider 
</p>
<blockquote>
<p>
<a class="mail-link" href="mailto:thierry@tetraedre.com"><span class="icon"> </span>thierry@tetraedre.com</a> 
</p>
</blockquote>
</blockquote>
<h1 id="Links">Links</h1>
<ul><li><strong><a class="ext-link" href="./index.html"><span class="icon"> </span>The QBluetooth library documentation</a></strong> 

</li><li><strong><a class="ext-link" href="http://wiki.forum.nokia.com/index.php/QuteMessenger_-_Bluetooth_Chat"><span class="icon"> </span>QuteMessenger - A Qt application using QBluetooth</a></strong>
</li><li><a class="ext-link" href="http://www.forum.nokia.com/info/sw.nokia.com/id/89261a1d-ed6d-4cc5-8855-8250a33de328/S60_Platform_Bluetooth_API_Developers_Guide.html"><span class="icon"> </span>S60 Platform: Bluetooth API Developer's Guide</a> 
</li><li><a class="ext-link" href="http://www.forum.nokia.com/info/sw.nokia.com/id/385f811a-2940-444f-b906-e5d3444e121c/S60_Platform_Bluetooth_OBEX_Example_v1_0_en.zip.html"><span class="icon"> </span>S60 Platform Bluetooth OBEX Example</a> 
</li><li><a class="ext-link" href="http://www.forum.nokia.com/info/sw.nokia.com/id/e56fccb6-2d70-4a02-9008-7b3e97927057/S60_Platform_Bluetooth_Point_to_Multipoint_Example.html"><span class="icon"> </span>S60 Platform Bluetooth Point to Multipoint Example</a> 
</li><li><a class="ext-link" href="http://library.forum.nokia.com/index.jsp?topic=/S60_5th_Edition_Cpp_Developers_Library/GUID-441D327D-D737-42A2-BCEA-FE89FBCA2F35/Chat/doc/index.html"><span class="icon"> </span>S60 blueooth Serial Port Chat</a> 
</li><li><a class="ext-link" href="http://wiki.forum.nokia.com/index.php/Bluetooth_Protocol"><span class="icon"> </span>Bluetooth Protocol</a>

</li><li><a class="ext-link" href="http://wiki.forum.nokia.com/index.php/Service_Discovery_in_Bluetooth"><span class="icon"> </span>Service Discovery in Bluetooth</a>
</li></ul><h1 id="Projectinformation">Project information</h1>
<ul><li>Project name: QBluetooth library
</li><li>Project identifier: qbluetooth
</li><li>Owner: lpvalente
</li><li>Create date: 2010-06-29 18:16:57
</li><li>Project url: <a href="https://projects.forum.nokia.com/qbluetooth">https://projects.forum.nokia.com/qbluetooth</a>
</li><li>Version control: <a class="ext-link" href="https://projects.forum.nokia.com/svn/qbluetooth"><span class="icon"> </span>https://projects.forum.nokia.com/svn/qbluetooth</a>
</li><li>Project (WebDAV) shared folder: <a class="ext-link" href="https://projects.forum.nokia.com/dav/qbluetooth"><span class="icon"> </span>https://projects.forum.nokia.com/dav/qbluetooth</a>

</li></ul>
<div class="contents">
<h3 class="version">SVN v.30 </h3></div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Aug 20 2010 11:34:08 for QBluetooth by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
